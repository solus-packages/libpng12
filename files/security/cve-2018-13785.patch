Index: libpng-1.2.59/pngrutil.c
===================================================================
--- libpng-1.2.59/pngrutil.c
+++ libpng-1.2.59/pngrutil.c	2018-11-22 20:13:33.871000929 +0100
@@ -2704,10 +2704,13 @@
    {
       png_uint_32 idat_limit = PNG_UINT_31_MAX;
       size_t row_factor =
-         (png_ptr->width * png_ptr->channels * (png_ptr->bit_depth > 8? 2: 1)
-          + 1 + (png_ptr->interlaced? 6: 0));
+        (size_t)png_ptr->width
+        * (size_t)png_ptr->channels
+        * (png_ptr->bit_depth > 8? 2: 1)
+        + 1
+        + (png_ptr->interlaced? 6: 0);
       if (png_ptr->height > PNG_UINT_32_MAX/row_factor)
-         idat_limit=PNG_UINT_31_MAX;
+         idat_limit = PNG_UINT_31_MAX;
       else
          idat_limit = png_ptr->height * row_factor;
       row_factor = row_factor > 32566? 32566 : row_factor;
